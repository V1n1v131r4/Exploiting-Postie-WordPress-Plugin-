# Exploiting Postie WordPress Plugin

This PoC describe how to exploit Postie WordPress plugin v1.9.40

I will describe two ways to explore the Postie v1.9.40 plugin for WordPress:

* [Spoofing valid user for post submission](https://github.com/V1n1v131r4/Exploiting-Postie-WordPress-Plugin-#poc-1---spoofing-valid-user-for-post-submission) // I published this [CVE-2019-20203](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20203)
* [XSS with JavaScript Polyglot](https://github.com/V1n1v131r4/Exploiting-Postie-WordPress-Plugin-#poc-2---xss-with-javascript-polyglot) // I published this [CVE-2019-20204](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-20204)

_______________________________________
### About Postie WordPress plugin

Postie allows you to create a post by simply sending an email. Create and edit your email in whatever email program you use. Click send and within a few minutes you have a new post!

More info [here](https://postieplugin.com/)

________________________________________
### PoC 1 - Spoofing valid user for post submission

The Postie plugin for WordPress only allows posting of articles submitted by authorized users through a mailing list registered in the plugin settings.

However through the email sender's spoofing technique (i used the [Anonymailer website](http://www.anonymailer.net)) it was possible to bypass the plugin settings and publish a post as having been sent by a valid user, as shown in the images below.

> **This PoC is hosted [here](https://poc.sejalivre.org/2019/12/27/test-postie-4/)**


_________________________________________

Below we have the images of first PoC:

![p8](http://ciber.sejalivre.org/WP/p8.png)

![p5](http://ciber.sejalivre.org/WP/p5.png)

![p6](http://ciber.sejalivre.org/WP/p6.png)

![p7](http://ciber.sejalivre.org/WP/p7.png)



________________________________________
### PoC 2 - XSS with JavaScript Polyglot

Another way to exploit the Postie plugin was a Cross-Site Script (XSS) attack using Polyglot JavaScript syntax, as follows:

`jaVasCript:/*--></title></style></textarea></script></xmp><svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(1)//'>`



The above syntax can be explained as follows:

* `jaVasCript`:: A label in ECMAScript; a URI scheme otherwise.
* `/-//*\/'/"/**/`: A multi-line comment in ECMAScript; a literal-breaker sequence.
* `(/* */oNcliCk=alert() )`: A tangled execution zone wrapped in invoking parenthesis!
* `//%0D%0A%0d%0a//`: A single-line comment in ECMAScript; a double-CRLF in HTTP response headers.
* `:` A sneaky HTML-tag-breaker sequence.
* `\x3csVg/\x3e`: An innocuous svg element.

This is a way to inject JavaScript code into post to bypass WordPress security policy through the Postie plugin vulnerability.


> **This PoC is hosted [here](https://poc.sejalivre.org/2019/12/27/test-postie-3/)**


_______________________________________
Below we have the images of secound PoC:


![p1](http://ciber.sejalivre.org/WP/p1.png)

![p2](http://ciber.sejalivre.org/WP/p2.png)

![p3](http://ciber.sejalivre.org/WP/p3.png)

![p4](http://ciber.sejalivre.org/WP/p4.png)


