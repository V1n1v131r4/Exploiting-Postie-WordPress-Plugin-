# Exploiting Postie WordPress Plugin

This PoC describe how to exploit Postie WordPress plugin v1.9.40

_______________________________________
### About Postie WordPress plugin

Postie allows you to create a post by simply sending an email. Create and edit your email in whatever email program you use. Click send and within a few minutes you have a new post!

More info [here](https://postieplugin.com/)


### Spoofing valid user for post submission

The Postie plugin for WordPress only allows posting of articles submitted by authorized users through a mailing list registered in the plugin settings.

However through the email sender's spoofing technique (i used the [Anonymailer website](http://www.anonymailer.net)) it was possible to bypass the plugin settings and publish a post as having been sent by a valid user, as shown in the images below.

* **This PoC is hosted [here](https://poc.sejalivre.org/2019/12/27/test-postie-4/)**



![p8](http://ciber.sejalivre.org/WP/p8.png)

![p5](http://ciber.sejalivre.org/WP/p5.png)

![p6](http://ciber.sejalivre.org/WP/p6.png)

![p7](http://ciber.sejalivre.org/WP/p7.png)




### XSS with JavaScript Polyglot

Another way to exploit the Postie plugin was a Cross-Site Script (XSS) attack using Polyglot JavaScript syntax, as follows:

`jaVasCript:/*--></title></style></textarea></script></xmp><svg/onload='+/"/+/onmouseover=1/+/[*/[]/+alert(1)//'>`



The above syntax can be explained as follows:

* `jaVasCript`:: A label in ECMAScript; a URI scheme otherwise.
* `/-//*\/'/"/**/`: A multi-line comment in ECMAScript; a literal-breaker sequence.
* `(/* */oNcliCk=alert() )`: A tangled execution zone wrapped in invoking parenthesis!
* `//%0D%0A%0d%0a//`: A single-line comment in ECMAScript; a double-CRLF in HTTP response headers.
* `:` A sneaky HTML-tag-breaker sequence.
* `\x3csVg/\x3e`: An innocuous svg element.



* **This PoC is hosted [here](https://poc.sejalivre.org/2019/12/27/test-postie-3/)**



Below we have the images of PoC:


![p1](http://ciber.sejalivre.org/WP/p1.png)

![p2](http://ciber.sejalivre.org/WP/p2.png)

![p3](http://ciber.sejalivre.org/WP/p3.png)

![p4](http://ciber.sejalivre.org/WP/p4.png)


